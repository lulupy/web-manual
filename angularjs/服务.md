# 服务 (service)


AngularJS使用服务架构来支持关键点分离的概念。服务是Javascript方法，用来执行特定的功能。这样生成独立的单元，方便测试和维护。控制器根据需要可以调用需要的服务。服务通常使用以来注入方式导入。

AngularJS提供了很多内建的服务，例如，$http，$route，$window，$location等等。每一个服务都对应一个指定的方法。例如$http用来创建服务器端AJAX调用，$route用来定义相关路由信息等等。所有的服务都使用$符号开始。

两种方式创建服务

- 工厂方法（Factory）
- 服务方法（Service )

使用工厂方法
这里我们定义一个工厂，并且添加方法：

```js
      var mainApp = angular.module("mainApp", []);
      mainApp.factory('MathService', function() {     

         var factory = {};  

         factory.multiply = function(a, b) {

            return a * b 

         }

         return factory;

      }); 
```

使用服务方法
这里定义一个服务，并且赋予方法。我们也可以注入已经存在的服务
```js
mainApp.service('CalcService', function(MathService){
 
    this.square = function(a) { 
 
        return MathService.multiply(a,a); 
 
    }
}) 
```


使用上面的服务的一个例子：
```html
<div ng-app="mainApp" ng-controller="CalcController">
  <p>输入一个数值: </p>
  <p><input type="number" ng-model="number" /></p>
  <button ng-click="square()">计算平方 X<sup>2</sup></button>
  <p>计算结果: {{result}}</p>
</div>
```



```js
mainApp.controller('CalcController', function($scope, CalcService) {
  $scope.square = function() {
    $scope.result = CalcService.square($scope.number);
  }
});
```



## $http服务

我们可以使用内置的$http服务直接同外部进行通信

$http服务是只能接受一个参数的函数，这个参数是一个对象，包含了用来生成HTTP请求的
配置内容。这个函数返回一个promise对象，具有success和error两个方法。


基本使用

```js
var promise = $http({
    url: 'http://127.0.0.1/user',
    method: 'GET',

});

promise.then(function(data, status, headers){
    $scope.users = data;
}, function(data, status, headers){
   console.log(data);
});
```


参数:

- url
- method
- headers
- params (字符串map或对象)

这个键的值是一个字符串map或对象，会被转换成查询字符串追加在URL后面。如果值不是
字符串，会被JSON序列化。
```js
// 参数会转化为?name=ari的形式
$http({
 params: {'name': 'ari'}
}) 
```
- data（字符串或对象）
这个对象中包含了将会被当作消息体发送给服务器的数据。通常在发送POST请求时使用。








