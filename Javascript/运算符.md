# 运算符

JavaScript中运算符主要用于连接简单表达式，组成一个复杂的表达式。常见的有算数表达式、比较表达式、逻辑表达式、赋值表达式等，也有单目运算符，指操作原始表达式。大多数运算符都由标点符号组成（+、>=、!），也有关键字表示的运算符，如typeof、delete、instanceof等。

一些运算符可以作用于任何数据类型（typeof），但大部分操作符希望操作数是特定的类型，而且大部分操作符会计算出（我们也常说返回）一个特定类型的值（typeof返回的全是string）。在JavaScript中运算符通常会根据需要对操作数进行类型转换，乘法操作符希望操作数是数字，但是 "3" * "5"也是合法的，JavaScript会自动将其转换为数字计算，返回Number 15。

有些操作符对不同的数据类型有不同的含义，比如 +

- 在两个操作数都是数字的时候，会做加法运算
- 两个参数都是字符串或在有一个参数是字符串的情况下会把另外一个参数转换为字符串做字符串拼接
- 在参数有对象的情况下会调用其valueOf或toString
- 在只有一个字符串参数的时候会尝试将其转换为数字
- 在只有一个数字参数的时候返回其正数值

```js
console.log(2+4);//6
console.log("2"+"4");//"24"
console.log(2+"4");//"24"
console.log(2+new Date());//"2Mon Jan 20 2014 17:15:01 GMT+0800 (China Standard Time)"
console.log(+"4");//4 
```

## 运算符类型

### 算数运算符

- 加法运算符（Addition）：x + y
- 减法运算符（Subtraction）： x - y
- 乘法运算符（Multiplication）： x * y
- 除法运算符（Division）：x / y
- 余数运算符（Remainder）：x % y
- 自增运算符（Increment）：++x 或者 x++
- 自减运算符（Decrement）：--x 或者 x--
- 求负运算符（Negate）：-x
- 数值运算符（Convert to number）： +x

### 赋值运算符

赋值运算符用于给变量赋值，最常见的赋值运算符，当然就是等号，表达式x=y表示将y赋值给x。除此之外，JavaScript还提供其他赋值运算符。

```js
x += y // 等同于 x = x + y
x -= y // 等同于 x = x - y
x *= y // 等同于 x = x * y
x /= y // 等同于 x = x / y
x %= y // 等同于 x = x % y

```

### 比较运算符

比较运算符比较两个值，然后返回一个布尔值，表示是否满足比较条件。JavaScript提供了8个比较运算符。

- == 相等
- === 严格相等
- !=不相等
- !== 严格不相等
- < 小于
- <= 小于或等于
- > 大于
- >= 大于或等于


### 布尔运算符

- ! 取反运算符
- && 且运算符
- || 或运算符
- condition? true case : false case 三元条件运算符



### 其它

#### 小括号

在JavaScript中，圆括号是一种运算符，它有两种用法：如果把表达式放在圆括号之中，作用是求值；如果跟在函数的后面，作用是调用函数。

把表达式放在圆括号之中，将返回表达式的值。

#### void

void运算符的作用是执行一个表达式，然后返回undefined。

#### 逗号运算符

逗号运算符用于对两个表达式求值，并返回后一个表达式的值。

## 运算符优先级与结合性

优先级什么意思大家都清楚，结合性是指多个具有同样优先级的运算符表达式中的运算顺序。有的运算符是左结合的，即运算从左到右执行，下面两个运算是一样的

```js
w = x + y + z;
w = (x + y) + z;
```

有的运算符是右结合的

```js
w = x = y = z;
w = (x = (y = z));
w = a: b: c ? d : e? f : g;
w = a? b : (c? d: (e? f : g));
```

运算符的优先级


|     运算符      |                操作                | 结合性 |          类型         |        |               |              |
|-----------------|------------------------------------|--------|-----------------------|--------|---------------|--------------|
| ++              | 自增                               | R      | lval->num             |        |               |              |
| --              | 自减                               | R      | lval->num             |        |               |              |
| -               | 求反                               | R      | num->num              |        |               |              |
| +（一个操作数） | 转换为数字                         | R      | num->num              |        |               |              |
| ~               | 按位求反                           | R      | int->int              |        |               |              |
| !               | 逻辑非                             | R      | bool->bool            |        |               |              |
| delete          | 删除属性                           | R      | lval->bool            |        |               |              |
| typeof          | 检测数据类型                       | R      | any->str              |        |               |              |
| void            | 返回undefined                      | R      | any->undefined        |        |               |              |
| *、/、%         | 乘、除、求余                       | L      | num,num->num          |        |               |              |
| +、-            | 加、减                             | L      | num,num->num          |        |               |              |
| +               | 字符串拼接                         | L      | str,str->str          |        |               |              |
| <、<=、>、>=    | 数字大小或字母表顺序               | L      | num/str,num/str->bool |        |               |              |
| instanceof      | 对象类型                           | L      | obj,function->bool    |        |               |              |
| in              | 测试属性是否存在                   | L      | str,obj->bool         |        |               |              |
| ==              | 判断相等                           | L      | any,any->bool         |        |               |              |
| ！=             | 判断不等                           | L      | any,any->bool         |        |               |              |
| ===             | 判断恒等                           | L      | any,any->bool         |        |               |              |
| !==             | 判断非恒等                         | L      | any,any->bool         |        |               |              |
| &&              | 逻辑与                             | L      | any,any->any          | 逻辑或 | L             | any,any->any |
| ?:              | 条件运算符                         | R      | bool,any,any->any     |        |               |              |
| =赋值           | *=、/=、+=、-=                     | 赋值   | 运算且赋值            | R      | lval,any->any |              |
| ,               | 忽略第一个操作数，返回第二个操作数 | L      | any,any->any          |        |               |              |

有几个我们需要注意的地方

1. typeof的优先级相当的高，比加减乘除都高，所以虽然是操作符，在在复杂表达式的时候我们还是习惯加括号，看个例子

```js
 typeof 2*3;//NaN
 typeof (2*3);//"number"
 typeof 2+3;// "number3"
```

2. ++、--是右结合的操作符（优先级最高的几个都是右结合），而且比加减乘除优先级高。同时自增、自减运算符的运算数得是左值（可以放在赋值符号左边的值），而不能是常数


```js
 4++; //ReferenceError: Invalid left-hand side expression in postfix operation
 var a=0,b=0;
 a+++b;//0
 a;//1，++优先级比+高，所以相当于(a++)+b
 b;//0
```

3. 赋值运算符的优先级相当的低

```js
 a = b == c; //等同于a = (b==c)
```

4. 逻辑非!也在优先级队列的前端，比加减乘除高，但逻辑与、逻辑或优先级很低，不如加减乘除

```js
!2*0; //0, 等价于(!2)*0
```

5. 一个关于逻辑运算符的有意思地方是其“短路”功能，相信大家都有所了解，但有些题目不那么单纯，会结合表达式计算值来考察

```js
 1 && 3;
 1 && "foo" || 0;
 1 || "foo" && 0
```

了解了逻辑运算符的“短路”特点，在知道原始表达式的“返回值”就是本身，题目就很简单了

### 相等

我们知道可以使用==或===判断两个值的相等性，其中区别相信大家清楚，===是严格意义的相等，只需注意NaN和NaN不等就行了。

而使用==的时候，javascript会帮我们做类型转换，造成一些匪夷所思的结果，那么使用==的时候会在哪些情况下做类型转换，又会换成什么样子？

- 如果两个值类型相同，则执行严格相等的运算
- 如果两个值的类型不同
    1. 如果一个是null，一个是undefined，那么相等
    2. 如果一个是数字，一个是字符串，先将字符串转为数字，然后比较
    3. 如果一个值是true/false则将其转为1/0比较
    4. 如果一个值是对象，一个是数字或字符串，则尝试使用valueOf和toString转换后比较
    5. 其它就不相等了

```js
null==undefined;//true
NaN==NaN;//false
"1"==true//true
```
